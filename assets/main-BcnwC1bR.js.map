{"version":3,"file":"main-BcnwC1bR.js","sources":["../../web-component.ts"],"sourcesContent":["// Polyfill for CommonJS modules used by ember-repl\n// ember-repl uses eval() to execute compiled code that expects CommonJS exports.\n// In strict mode (default in ES modules), eval() creates a new scope and doesn't\n// have access to local variables. The evalSnippet function in ember-repl defines\n// `exports` and `require` as local variables, but the eval() can't access them.\n//\n// Solution: Patch the eval function to use indirect eval (0, eval)() which runs\n// in global scope, and provide global exports/module/require that the evalSnippet\n// can use.\nif (typeof window !== 'undefined') {\n  const originalEval = window.eval;\n\n  // @ts-expect-error - Patching eval\n  window.eval = function (code: string) {\n    // Check if this is CommonJS code from ember-repl\n    if (\n      typeof code === 'string' &&\n      (code.includes('exports.') || code.includes('module.exports'))\n    ) {\n      // Use indirect eval to run in global scope\n      // This allows the code to access window.exports and window.require\n      return (0, eval)(code);\n    }\n\n    // For other code, use direct eval (local scope)\n    return originalEval.call(this, code);\n  };\n\n  // Add a fallback window.require for modules not in the importMap\n  // @ts-expect-error - Adding require polyfill to window\n  if (!window.require) {\n    // @ts-expect-error - Adding require polyfill to window\n    window.require = function (moduleName: string) {\n      console.warn(\n        `[web-component] window.require called for module: ${moduleName}`\n      );\n      throw new Error(\n        `Module not found: ${moduleName}. Please add it to the importMap.`\n      );\n    };\n  }\n}\n\nimport type Application from '@ember/application';\nimport App from './app/app';\nimport config from 'standalone-app/config/environment';\n\nexport interface WrapAppOptions {\n  tagName?: string;\n  styles?: string;\n  rootElementTag?: string;\n  appConfig?: unknown;\n}\n\nexport function wrapApp(\n  App: typeof Application,\n  options: WrapAppOptions = {}\n): typeof HTMLElement {\n  class WrappedAppElement extends HTMLElement {\n    connectedCallback() {\n      const shadow = this.attachShadow({ mode: 'open' });\n\n      /**\n       * We originally defaulted to body here because we were testing with the ember-welcome-page and it\n       * had specific css targeting the body. The more we experimented and thought about it we thought\n       * it was a decent thing for an application wrapped in a web-component to have it's own body,\n       * and nobody seemed to be telling us it was a bad idea so ðŸ¤·\n       */\n      const rootElement = document.createElement(\n        options.rootElementTag ?? 'body'\n      );\n\n      if (options.styles) {\n        const style = document.createElement('style');\n        style.textContent = options.styles;\n        shadow.appendChild(style);\n      }\n\n      const appConfig = {\n        ...(options.appConfig ?? {}),\n        rootElement,\n      };\n      App.create(appConfig);\n\n      shadow.append(rootElement);\n    }\n  }\n\n  if (options.tagName) {\n    customElements.define(options.tagName, WrappedAppElement);\n  }\n\n  return WrappedAppElement;\n}\n\nimport styles from './app/styles/app.css?inline';\n\nexport default wrapApp(App, {\n  tagName: 'app-webcomponent',\n  styles,\n  appConfig: config.APP,\n});\n"],"names":["window","originalEval","eval","code","includes","call","this","require","moduleName","console","warn","Error","App","options","WrappedAppElement","HTMLElement","connectedCallback","shadow","attachShadow","mode","rootElement","document","createElement","rootElementTag","styles","style","textContent","appendChild","appConfig","create","append","tagName","customElements","define","wrapApp","config","APP"],"mappings":"6CASA,GAAsB,oBAAXA,OAAwB,CACjC,MAAMC,EAAeD,OAAOE,KAG5BF,OAAOE,KAAO,SAAUC,GAEtB,MACkB,iBAATA,IACNA,EAAKC,SAAS,aAAeD,EAAKC,SAAS,oBAIrC,EAAIF,MAAMC,GAIZF,EAAaI,KAAKC,KAAMH,EACjC,EAIKH,OAAOO,UAEVP,OAAOO,QAAU,SAAUC,GAIzB,MAHAC,QAAQC,KACN,qDAAqDF,KAEjD,IAAIG,MACR,qBAAqBH,qCAEzB,EAEJ,EAaO,SACLI,EACAC,EAA0B,IAE1B,MAAMC,UAA0BC,YAC9BC,iBAAAA,GACE,MAAMC,EAASX,KAAKY,aAAa,CAAEC,KAAM,SAQnCC,EAAcC,SAASC,cAC3BT,EAAQU,gBAAkB,QAG5B,GAAIV,EAAQW,OAAQ,CAClB,MAAMC,EAAQJ,SAASC,cAAc,SACrCG,EAAMC,YAAcb,EAAQW,OAC5BP,EAAOU,YAAYF,EACrB,CAEA,MAAMG,EAAY,IACZf,EAAQe,WAAa,GACzBR,eAEFR,EAAIiB,OAAOD,GAEXX,EAAOa,OAAOV,EAChB,EAGEP,EAAQkB,SACVC,eAAeC,OAAOpB,EAAQkB,QAASjB,EAI3C,CAIeoB,CAAQtB,EAAK,CAC1BmB,QAAS,mBACTP,m1DACAI,UAAWO,EAAOC"}